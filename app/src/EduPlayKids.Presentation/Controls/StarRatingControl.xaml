<?xml version="1.0" encoding="utf-8" ?>
<ContentView x:Class="EduPlayKids.App.Controls.StarRatingControl"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Name="StarRatingRoot">

    <ContentView.Resources>
        <ResourceDictionary>
            <!-- Note: Animations are handled programmatically in code-behind for .NET MAUI compatibility -->

            <!-- Child-friendly color definitions -->
            <Color x:Key="StarGoldColor">#FFD700</Color>
            <Color x:Key="StarSilverColor">#C0C0C0</Color>
            <Color x:Key="StarGlowColor">#FFEB3B</Color>
            <Color x:Key="ChildSafeBlue">#4A90E2</Color>
            <Color x:Key="HappyGreen">#A3BE8C</Color>
        </ResourceDictionary>
    </ContentView.Resources>

    <Grid x:Name="MainContainer"
          BackgroundColor="Transparent"
          VerticalOptions="Center"
          HorizontalOptions="Center">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Achievement Title -->
        <Label x:Name="AchievementTitle"
               Grid.Row="0"
               Text="{Binding Source={x:Reference StarRatingRoot}, Path=Title}"
               FontFamily="Nunito"
               FontSize="24"
               FontAttributes="Bold"
               TextColor="{StaticResource ChildSafeBlue}"
               HorizontalTextAlignment="Center"
               Margin="0,0,0,15"
               IsVisible="{Binding Source={x:Reference StarRatingRoot}, Path=ShowTitle}" />

        <!-- Star Display Container -->
        <Frame x:Name="StarContainer"
               Grid.Row="1"
               BackgroundColor="White"
               CornerRadius="25"
               HasShadow="True"
               Padding="20"
               MinimumWidthRequest="240"
               HorizontalOptions="Center">

            <!-- Glow effect for celebrations -->
            <Ellipse x:Name="StarGlow"
                     Fill="{StaticResource StarGlowColor}"
                     Opacity="0"
                     WidthRequest="200"
                     HeightRequest="200"
                     HorizontalOptions="Center"
                     VerticalOptions="Center"
                     IsVisible="{Binding Source={x:Reference StarRatingRoot}, Path=ShowGlowEffect}" />

            <StackLayout x:Name="StarStack"
                         Orientation="Horizontal"
                         Spacing="12"
                         HorizontalOptions="Center"
                         VerticalOptions="Center">

                <!-- Star 1 -->
                <Grid x:Name="Star1Grid">
                    <Label x:Name="Star1"
                           Text="⭐"
                           FontSize="48"
                           TextColor="{StaticResource StarSilverColor}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />

                    <!-- Touch target for interaction -->
                    <Button x:Name="Star1Button"
                            BackgroundColor="Transparent"
                            BorderColor="Transparent"
                            WidthRequest="60"
                            HeightRequest="60"
                            CornerRadius="30"
                            Clicked="OnStarTapped"
                            CommandParameter="1" />
                </Grid>

                <!-- Star 2 -->
                <Grid x:Name="Star2Grid">
                    <Label x:Name="Star2"
                           Text="⭐"
                           FontSize="48"
                           TextColor="{StaticResource StarSilverColor}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />

                    <Button x:Name="Star2Button"
                            BackgroundColor="Transparent"
                            BorderColor="Transparent"
                            WidthRequest="60"
                            HeightRequest="60"
                            CornerRadius="30"
                            Clicked="OnStarTapped"
                            CommandParameter="2" />
                </Grid>

                <!-- Star 3 -->
                <Grid x:Name="Star3Grid">
                    <Label x:Name="Star3"
                           Text="⭐"
                           FontSize="48"
                           TextColor="{StaticResource StarSilverColor}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />

                    <Button x:Name="Star3Button"
                            BackgroundColor="Transparent"
                            BorderColor="Transparent"
                            WidthRequest="60"
                            HeightRequest="60"
                            CornerRadius="30"
                            Clicked="OnStarTapped"
                            CommandParameter="3" />
                </Grid>
            </StackLayout>
        </Frame>

        <!-- Encouraging Message -->
        <Frame x:Name="MessageFrame"
               Grid.Row="2"
               BackgroundColor="{StaticResource HappyGreen}"
               CornerRadius="20"
               HasShadow="False"
               Padding="15,10"
               Margin="0,15,0,0"
               HorizontalOptions="Center"
               IsVisible="{Binding Source={x:Reference StarRatingRoot}, Path=ShowMessage}">

            <Label x:Name="EncouragingMessage"
                   Text="{Binding Source={x:Reference StarRatingRoot}, Path=Message}"
                   FontFamily="Nunito"
                   FontSize="16"
                   FontAttributes="Bold"
                   TextColor="White"
                   HorizontalTextAlignment="Center"
                   LineBreakMode="WordWrap" />
        </Frame>

        <!-- Celebration Confetti (overlay) -->
        <Grid x:Name="CelebrationOverlay"
              Grid.RowSpan="3"
              BackgroundColor="Transparent"
              IsVisible="False"
              InputTransparent="True">

            <!-- Confetti particles -->
            <Label x:Name="Confetti1" Text="🎉" FontSize="20" TextColor="Red" Opacity="0" />
            <Label x:Name="Confetti2" Text="🎊" FontSize="18" TextColor="Blue" Opacity="0" />
            <Label x:Name="Confetti3" Text="⭐" FontSize="16" TextColor="Gold" Opacity="0" />
            <Label x:Name="Confetti4" Text="🌟" FontSize="22" TextColor="Yellow" Opacity="0" />
            <Label x:Name="Confetti5" Text="🎉" FontSize="19" TextColor="Green" Opacity="0" />
        </Grid>
    </Grid>
</ContentView>